
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>Tôi đã xây dựng 1 phần mềm mã nguồn mở như thế nào - Blog kỹ thuật máy tính</title>
	<meta name="author" content="kỹ thuật máy tính">

	
	<meta name="description" content="Tôi đã Xây Dựng 1 Phần Mềm Mã Nguồn Mở Như Thế Nào Lưu ý trước khi đọc tiếp: Ở bài viết này tác giả dùng chữ “hacker”, không phải theo nghĩa chỉ &hellip;">
	

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

	<link href="/atom.xml" rel="alternate" title="Blog kỹ thuật máy tính" type="application/atom+xml">
	
	<link rel="canonical" href="http://git@github.com.github.com/blog/2014/08/01/toi-da-xay-dung-1-phan-mem-ma-nguon-mo-nhu-the-nao/">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
  <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
    });
  </script>
	<link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,400,700' rel='stylesheet' type='text/css'>
	
</head>


<body>
	<div class="container">
		<div class="left-col">
			<div class="intrude-less">
			<header id="header" class="inner"><div class="profilepic">	
	<script src="/javascripts/md5.js"></script>
	<img src='/images/logo.jpg' alt='Profile Picture' style='width: 160px;' />
</div>
<h1><a href="/">Blog kỹ thuật máy tính</a></h1>
<p class="subtitle">kỹ thuật máy tính</p>
<nav id="main-nav"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
</ul>
</nav>
<nav id="sub-nav">
	<div class="social">
		
		<a class="facebook" href="http://www.facebook.com/pages/ktmtgithubio/486208978117754" title="Facebook">Facebook</a>
		
		
		
		
		
		
		
		
		
		<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
	</div>
</nav>

</header>				
			</div>
		</div>	
		<div class="mid-col">
			
				
			
			<div class="mid-col-container">
				<div id="content" class="inner"><article class="post" itemscope itemtype="http://schema.org/BlogPosting">
	<h1 class="title" itemprop="name">Tôi đã Xây Dựng 1 Phần Mềm Mã Nguồn Mở Như Thế Nào</h1>
	<div class="entry-content" itemprop="articleBody"><p><em>Lưu ý trước khi đọc tiếp: Ở bài viết này tác giả dùng chữ “hacker”, không phải theo nghĩa chỉ những người làm trong lĩnh vực bảo mật hay an toàn thông tin. “Hacker” ở đây là những kỹ sư, những nhà phát triền có năng lực tự tìm hiểu, mày mò, có kỹ năng “bắt máy tính phục vụ sở thích của mình”.</em></p>
<h1 id="ý-tưởng">Ý tưởng</h1>
<p>Nếu bạn là một hacker làm việc nhiều với Mac hoặc Linux, chắc các bạn chẳng xa lạ gì với terminal - giao diện dòng lệnh cơ bản nhất của hệ điều hành Unix. Tôi là một hacker bị “cuồng terminal”, <code>zsh</code>, <code>prezto</code>, <code>tmux</code>, <code>irssi</code>, <code>vim</code>, <code>tig</code> là những tools ưa thích nhất. Tôi từng có ước mơ muốn từ bỏ các giao diện đồ hoạ, có thể lập trình, chat chit, nghe nhạc v.v.. ngay trên môi trường không-đồ-hoạ.</p>
<p>Bên cạnh đó, mặc dù không mấy mặn mà với Facebook nhưng gần đây lại bị nghiện Twitter, trong đầu tôi luôn hiện lên câu hỏi: làm thế nào để cũng có thể tương tác với Twitter chỉ qua terminal của MacOSX ?</p>
<p>Trên thực tế đã có khá nhiều thư viện mã nguồn mở có thể đáp ứng được nhu cầu trên. <a href="https://github.com/sferik/t">t</a> hay <a href="https://github.com/jugyo/earthquake">earthquake</a> là những gem(Ruby) được viết rất bài bản và đa tính năng. Tuy nhiên tôi đã quyết định tự viết một phần mềm của riêng mình, bởi tự phát triền và làm sản phẩm của mình được cộng đồng đón nhận là một mục tiêu mới mẻ và đầy thử thách.</p>
<p>Trong bài viết này, tôi sẽ giới thiệu với các bạn tôi đã xây dựng một phần mềm mã nguồn mở như thế nào, về cả kỹ năng phát triển và cách mang phần mềm của mình đến với cộng đồng hacker trên thế giới.</p>
<h1 id="xác-định-mục-tiêu">Xác định mục tiêu</h1>
<p>Khi bạn bắt đầu viết một phần mềm mã nguồn mở, điều quan trọng đầu tiên sẽ là : <strong>đã có ai thực hiện ý tưởng của bạn chưa</strong> và họ <strong>đã thực hiện được tốt đến đâu</strong>. Khi chuẩn bị viết phần mềm của mình, tôi nhận thấy <a href="https://github.com/sferik/t">t</a> giống như <em>1 twitter command trên Unix</em>, focus vào khả năng pipe với các command khác. Ngược lại, <a href="https://github.com/jugyo/earthquake">earthquake</a> là 1 app hoàn chỉnh nhưng <em>xử lý hiển thị tweets lại chưa thật tốt</em>.</p>
<p>Và từ đó <a href="https://github.com/DTVD/rainbowstream">Rainbow Stream</a> ra đời. Bạn có thể nhận ra 2 điểm nêu trên khi nhìn vào cách thức hoạt động của app dưới đây:</p>
<figure>
<img src="https://raw.githubusercontent.com/DTVD/rainbowstream/master/screenshot/rs.gif" alt="gif" /><figcaption>gif</figcaption>
</figure>
<h1 id="tạo-nên-sự-khác-biệt">Tạo nên sự khác biệt</h1>
<p>Để gây được ấn tượng với người dùng, sản phẩm của bạn vẫn cần có 1 đến 2 tính năng nổi trội. Bạn sẽ không muốn phần mềm mình viết ra mãi chỉ là “alternative to xxx or yyy, can consider if zzz stops development”. Ở đây, tôi xây đựng <a href="https://github.com/DTVD/rainbowstream">Rainbow Stream</a> tập trung vào 2 tính năng chính:</p>
<ul>
<li>Khả năng hiển thị màu sắc trên các terminal hỗ trợ 256 màu, cung cấp sẵn 1 số themes nổi tiếng.</li>
<li>Hiện thị ảnh <em>trực tiếp trên terminal</em>.</li>
</ul>
<p>Chúng ta sẽ đi vào cụ thể trong các phần tiếp theo.</p>
<h2 id="hiển-thị-màu-của-terminal">Hiển thị màu của terminal</h2>
<p>Hầu hết các terminal hiện đại đều hỗ trợ hiển thị <em>256 ANSI colors</em>. Trên shell bạn có thể dễ dàng in ra chữ theo các màu định sẵn bẳng các dùng <em>Escape character</em> như dưới đây</p>
<div class="bogus-wrapper">
<notextile>
<figure class='code'><figcaption>
<span></span>
</figcaption>
<div class="highlight">
<table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>$ echo -e "\e[31mRed"
</span><span class='line'>$ echo -e "\e[32mGreen"
</span><span class='line'>$ echo -e "\e[33mYellow"
</span><span class='line'>$ echo -e "\e[34mBlue"
</span><span class='line'>$ echo -e "\e[35mMagenta"
</span><span class='line'>$ echo -e "\e[36mCyan"
</span><span class='line'>$ echo -e "\e[37mLight gray"</span></code></pre></td></tr></table>
</div>
</figure>
</notextile>
</div>
<p>Hiện thị màu trên Python có thể được viết gọn theo function như sau</p>
<div class="bogus-wrapper">
<notextile>
<figure class='code'><figcaption>
<span></span>
</figcaption>
<div class="highlight">
<table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'>def basic_color(code):
</span><span class='line'>    """
</span><span class='line'>    16 colors supported
</span><span class='line'>    """
</span><span class='line'>    def inner(text, bold=True):
</span><span class='line'>        c = code
</span><span class='line'>        if bold:
</span><span class='line'>            c = "1;%s" % c
</span><span class='line'>        return "\033[%sm%s\033[0m" % (c, text)
</span><span class='line'>    return inner
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>def term_color(code):
</span><span class='line'>    """
</span><span class='line'>    256 colors supported
</span><span class='line'>    """
</span><span class='line'>    def inner(text):
</span><span class='line'>        c = code
</span><span class='line'>        return "\033[38;5;%sm%s\033[0m" % (c, text)
</span><span class='line'>    return inner</span></code></pre></td></tr></table>
</div>
</figure>
</notextile>
</div>
<p>Sử dụng những function ở trên thực tế rất đơn giản:</p>
<div class="bogus-wrapper">
<notextile>
<figure class='code'><figcaption>
<span></span>
</figcaption>
<div class="highlight">
<table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'>black = basic_color('30')
</span><span class='line'>red = basic_color('31')
</span><span class='line'>green = basic_color('32')
</span><span class='line'>yellow = basic_color('33')
</span><span class='line'>blue = basic_color('34')
</span><span class='line'>magenta = basic_color('35')
</span><span class='line'>cyan = basic_color('36')
</span><span class='line'># Print
</span><span class='line'>print green("Green text") 
</span><span class='line'>print term_color('112')("A text with ANSI color 112")</span></code></pre></td></tr></table>
</div>
</figure>
</notextile>
</div>
<p>Giả sử chúng ta có một tập vô hạn các word không biết trước. muốn mỗi word có một màu và các word lặp lại sẽ có màu giống nhau, chúng ta có thể dùng <em>Memoization</em> trong Python như sau:</p>
<div class="bogus-wrapper">
<notextile>
<figure class='code'><figcaption>
<span></span>
</figcaption>
<div class="highlight">
<table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'>import itertools
</span><span class='line'>from functools import wraps
</span><span class='line'>cyc = itertools.cycle([black,red,green,yellow,blue,magenta,cyan])
</span><span class='line'>
</span><span class='line'>def Memoize(func):
</span><span class='line'>    cache = {}
</span><span class='line'>    @wraps(func)
</span><span class='line'>    def wrapper(*args):
</span><span class='line'>        if args not in cache:
</span><span class='line'>            cache[args] = func(*args)
</span><span class='line'>        return cache[args]
</span><span class='line'>    return wrapper
</span><span class='line'>
</span><span class='line'>@Memoize
</span><span class='line'>def cycle_color(s):
</span><span class='line'>    return next(cyc)(s)
</span><span class='line'>
</span><span class='line'>for s in ["w1","w2","w3","w1","w4"]:
</span><span class='line'>    print cycle_color(s) # Now every word will has its color, while the 1st "w1" and 3nd "w2" ends up with same color</span></code></pre></td></tr></table>
</div>
</figure>
</notextile>
</div>
<p>Các màu sắc hiển thị trong <a href="https://github.com/DTVD/rainbowstream">Rainbow Stream</a> đều dựa theo nguyên lý nói trên.</p>
<h2 id="hiển-thị-ảnh-trên-terminal">Hiển thị ảnh trên terminal</h2>
<p>Để nói cụ thể về phần này sẽ hơi dài dòng, nhưng có thể tóm gọn trong các ý sau đây:</p>
<ul>
<li>Python có một thư viện xử lý ảnh rất tốt là <code>Pillow</code>. <code>Pillow</code> cung cấp những tính năng cở bản để tháo tác với lượng thông tin trong một tấm ảnh. Nhược điểm của Pillow là khá buggy khi install và không hỗ trợ Window.</li>
<li>Tôi dùng Pillow để đọc thông tin về từng Pixel trong một ảnh, mỗi pixel sẽ có 4 chỉ số gồm 3 chỉ số màu (R,G,B) và 1 chỉ số về độ trong (A).</li>
<li>Màu sắc của 1 pixel nói trên được quy đổi về tập 256 màu ANSI hiển thị được trên terminal (phương pháp xem ở dưới).</li>
<li>Với mỗi pixel, tôi in ra như 1 ký tự Space với màu ANSI tương ứng, sử dụng hàm <code>term_color</code> ở đoạn trên.</li>
</ul>
<p>Trong các bước trên thì bước quy đổi màu là quan trọng nhất. Thuật toán quy đổi dùng ở đây là phương pháp tính khoảng cách vector trong không gian Euclide 3 chiều:</p>
<ul>
<li>Mỗi màu RGB coi như 1 vector với 3 chiều là R (Red), G (Green), B (Blue).</li>
<li>Mỗi màu ANSI (trong tập 256 màu của terminal) cũng tương ứng với 1 vector 3 chiều. Chúng ta có tập tiêu chuẩn 256 vector ở đây.</li>
<li>Mỗi vector RGB của 1 pixel sẽ được quy về vector tiêu chuẩn ANSI <em>gần nhất</em>. Công thức tính khoảng cách giữa 2 đầu vector như trong hình học 3 chiều : <code>((x1-x2)**2 + (y1-y2)**2 + (z1-z2)**2)**0.5</code></li>
</ul>
<p>Như vậy “ảnh” ở trên terminal thực chất là các ký tự Space với màu ANSI đã được quy đổi và in ra liên tiếp :)</p>
<h2 id="các-vấn-đề-kỹ-thuật-khác">Các vấn đề kỹ thuật khác</h2>
<p>Để hoàn thiện <a href="https://github.com/DTVD/rainbowstream">Rainbow Stream</a> thực ra cần một kỹ năng khác như lập trình với thread, tạo interactive input bẳng readline, gọi chương trình C compile sẵn hay xử lý chung cho cả Python 2 và Python 3 … Trong khuôn khổ một bài viết tôi khó có thể trình bày hết những vấn đề trên, vì vậy nếu bạn quan tâm hãy mở thẳng <a href="https://github.com/DTVD/rainbowstream">Github repo</a> và đọc source code. <a href="https://github.com/DTVD/rainbowstream">Rainbow Stream</a> là một phần mềm mã nguồn mở với MIT license.</p>
<p>(… còn tiếp - Làm thế nào để mang phần mềm của mình đến với thế giới hacker …)</p></div>

</article>

	<div class="share">
	<div class="addthis_toolbox addthis_default_style ">
	
	<a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
	
	
	<a class="addthis_button_tweet"></a>
	
	
	<a class="addthis_counter addthis_pill_style"></a>
	</div>
  <script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid="></script>
</div>



<section id="comment">
    <h1 class="title">Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
</section>
</div>
			</div>
			<footer id="footer" class="inner">Copyright &copy; 2014

    kỹ thuật máy tính


</footer>
			<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->


<script type="text/javascript">
      var disqus_shortname = 'ktmt';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://git@github.com.github.com/blog/2014/08/01/toi-da-xay-dung-1-phan-mem-ma-nguon-mo-nhu-the-nao/';
        var disqus_url = 'http://git@github.com.github.com/blog/2014/08/01/toi-da-xay-dung-1-phan-mem-ma-nguon-mo-nhu-the-nao/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-41828637-2', 'ktmt.github.io');
  ga('send', 'pageview');

</script>	


		</div>
	</div>
</body>
</html>
