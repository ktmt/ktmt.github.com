<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Code golf | Blog kỹ thuật máy tính]]></title>
  <link href="http://git@github.com.github.com/blog/categories/code-golf/atom.xml" rel="self"/>
  <link href="http://git@github.com.github.com/"/>
  <updated>2015-03-08T14:45:59+09:00</updated>
  <id>http://git@github.com.github.com/</id>
  <author>
    <name><![CDATA[kỹ thuật máy tính]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[99-bottles-of-beer]]></title>
    <link href="http://git@github.com.github.com/blog/2013/06/02/99-bottles-of-beer/"/>
    <updated>2013-06-02T19:47:00+09:00</updated>
    <id>http://git@github.com.github.com/blog/2013/06/02/99-bottles-of-beer</id>
    <content type="html"><![CDATA[<h2 id="the-song-and-the-home-page">The song, and the home page</h2>
<p>Đầu tiên có thể độc giả sẽ tự hỏi ý nghĩa của tiêu đề bài viết là gì ? Vậy trước hết mời bạn ghé qua <a href="http://99-bottles-of-beer.net">home page</a> và enjoy the <a href="http://www.youtube.com/watch?v=qVjCag8XoHQ">song</a></p>
<p>99-bottles-of-beer cũng từng là đề bài của code golf và phpgolf. Mission của chúng ta là code 1 đoạn PHP snippet print <a href="http://99-bottles-of-beer.net/lyrics.html">lyric</a> của bài hát mà dung lượng đoạn code là nhỏ nhất. Logic thật đơn giản phải không :D</p>
<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>lyric</span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>99 bottles of beer on the wall, 99 bottles of beer. Take one down and pass it around, 98 bottles of beer on the wall.&lt;/p>
</span><span class='line'>&lt;p>98 bottles of beer on the wall, 98 bottles of beer. Take one down and pass it around, 97 bottles of beer on the wall.&lt;/p>
</span><span class='line'>&lt;p>97 bottles of beer on the wall, 97 bottles of beer. Take one down and pass it around, 96 bottles of beer on the wall.&lt;/p>
</span><span class='line'>&lt;p>…&lt;/p>
</span><span class='line'>&lt;p>1 bottle of beer on the wall, 1 bottle of beer. Go to the store and buy some more, 99 bottles of beer on the wall.</span></code></pre></td></tr></table></div></figure></notextile></div></p>
<p>Với mục tiêu dùng ít code nhất có thể, tôi sẽ không dùng cấu trúc rẽ nhánh if-else, thay vào đó là ternary operator của PHP ( có nghĩa là bạn có thể viết “(condition)?true-action:false-action” thay vì “if (condition) {true-action} else {false-action}” )</p>
<p>Đoạn code đầu tiên tôi nghĩ ra trong đầu như sau:</p>
<div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>sol1.php </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="x"> </span><span class="cp">&lt;?php</span>
</span><span class='line'>  <span class="nv">$a</span><span class="o">=</span><span class="s2">&quot;beer on the wall&quot;</span><span class="p">;</span>
</span><span class='line'>  <span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">99</span><span class="p">;</span><span class="nv">$i</span><span class="o">&gt;=</span><span class="mi">1</span><span class="p">;</span><span class="nv">$i</span><span class="err">–</span><span class="p">){</span> <span class="o">&lt;</span><span class="nx">span</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&quot;math&quot;</span><span class="o">&gt;</span><span class="nx">\</span><span class="p">(</span><span class="nx">x</span><span class="o">=</span><span class="p">(</span><span class="nx">\</span><span class="p">)</span><span class="o">&lt;/</span><span class="nx">span</span><span class="o">&gt;</span><span class="nx">i</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span><span class="o">?</span><span class="err">“</span><span class="nx">bottle</span><span class="err">”</span><span class="o">:</span><span class="err">“</span><span class="nx">bottles</span><span class="err">”</span><span class="p">;</span> <span class="o">&lt;</span><span class="nx">span</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&quot;math&quot;</span><span class="o">&gt;</span><span class="nx">\</span><span class="p">(</span><span class="nx">b</span><span class="o">=&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="nx">p</span><span class="o">&amp;</span><span class="nx">gt</span><span class="p">;</span><span class="nx">\</span><span class="p">)</span><span class="o">&lt;/</span><span class="nx">span</span><span class="o">&gt;</span><span class="nx">i</span> <span class="nv">$x</span> <span class="nx">of</span> <span class="nv">$a</span><span class="p">,</span> <span class="nv">$i</span> <span class="nv">$x</span> <span class="nx">of</span> <span class="nx">beer</span><span class="o">.&lt;</span><span class="nx">br</span><span class="o">&gt;</span><span class="err">“</span><span class="p">;</span> <span class="o">&lt;</span><span class="nx">span</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&quot;math&quot;</span><span class="o">&gt;</span><span class="nx">\</span><span class="p">(</span><span class="nx">b</span><span class="o">.=</span><span class="p">(</span><span class="nx">\</span><span class="p">)</span><span class="o">&lt;/</span><span class="nx">span</span><span class="o">&gt;</span><span class="nx">i</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span><span class="o">?</span><span class="err">”</span><span class="nx">Go</span> <span class="nx">to</span> <span class="nx">the</span> <span class="nx">store</span> <span class="k">and</span> <span class="nx">buy</span> <span class="nx">some</span> <span class="nx">more</span><span class="p">,</span> <span class="mi">99</span> <span class="nx">bottles</span> <span class="nx">of</span> <span class="o">&lt;</span><span class="nx">span</span> <span class="nx">class</span><span class="o">=</span><span class="s2">&quot;math&quot;</span><span class="o">&gt;</span><span class="nx">\</span><span class="p">(</span><span class="nx">a</span><span class="o">.&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">:&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="nx">Take</span> <span class="nx">one</span> <span class="nx">down</span> <span class="k">and</span> <span class="nx">pass</span> <span class="nx">it</span> <span class="nx">around</span><span class="p">,</span> <span class="o">&amp;</span><span class="nx">quot</span><span class="p">;</span><span class="o">.</span><span class="p">(</span><span class="nx">\</span><span class="p">)</span><span class="o">&lt;/</span><span class="nx">span</span><span class="o">&gt;</span><span class="nx">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.&amp;</span><span class="nx">quot</span><span class="p">;</span> <span class="nv">$x</span> <span class="nx">of</span> <span class="nv">$a</span><span class="o">.</span>
</span><span class='line'><span class="o">&lt;/</span><span class="nx">p</span><span class="o">&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="err">“</span><span class="p">;</span> <span class="k">print</span> <span class="nv">$b</span><span class="p">;</span> <span class="p">}</span> <span class="o">?&amp;</span><span class="nx">gt</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>
<h2 id="optimize">Optimize</h2>
<p>Bạn thử ls -l sẽ thấy đoạn code trên có dung lượng 288 bytes!</p>
<p>Để rút ngắn đoạn code trên, đầu tiên tôi nhớ lại những kiến thức cơ bản về PHP: dấu space hoàn toàn không cần thiết, và ký tự “?&gt;” ở cuối cũng có thể bỏ đi PHP long tag ở đầu có thể thay = PHP short tag</p>
<div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>sol2.php </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="x"> &amp;lt;? &lt;span class=&quot;math&quot;&gt;\(a=&amp;quot;beer on the wall&amp;quot;; for(\)&lt;/span&gt;i=99;&lt;span class=&quot;math&quot;&gt;\(i&amp;gt;=1;\)&lt;/span&gt;i–){ &lt;span class=&quot;math&quot;&gt;\(x=(\)&lt;/span&gt;i==1)?“bottle”:“bottles”; &lt;span class=&quot;math&quot;&gt;\(b=&amp;quot;&amp;lt;p&amp;gt;\)&lt;/span&gt;i $x of $a, $i $x of beer.&lt;br&gt;“; &lt;span class=&quot;math&quot;&gt;\(b.=(\)&lt;/span&gt;i==1)?”Go to the store and buy some more, 99 bottles of &lt;span class=&quot;math&quot;&gt;\(a.&amp;quot;:&amp;quot;Take one down and pass it around, &amp;quot;.(\)&lt;/span&gt;i-1).&amp;quot; $x of $a.</span>
</span><span class='line'><span class="x">&lt;/p&gt;</span>
</span><span class='line'><span class="x">&lt;p&gt;“; print $b; } </span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>
<p>263 bytes!</p>
<p>Làm thế nào để rút ngắn hơn nữa ? Nếu để ý vào những chi tiết nhỏ hơn, bạn sẽ thấy:</p>
<ul>
<li>trong điều kiện vòng lặp, thay “<span class="math">\(i&gt;=1&quot; bằng &quot;\)</span>i&gt;0”</li>
<li>“(<span class="math">\(i==1)?&quot; là quá dài. Ta có thể bỏ đi 2 dấu ngoặc &quot;\)</span>i==1?”</li>
<li>print có thể thay bằng echo. ( Thực tế trong PHP bạn còn có thể thay rtrim -&gt; chop, explode -&gt; split, implode -&gt; join, preg_split -&gt; split (trong 1 vài trường hợp) và preg_replace -&gt; preg_filter trong hầu hết các TH )</li>
<li>“<span class="math">\(x=(\)</span>i==1)?”bottle“:”bottles“;” có thể được viết lại : “<span class="math">\(x=&#39;bottle&#39;;\)</span>i==1?:$x.=‘s’;”</li>
<li>Mỗi lần sử dụng biến $a ta đều có “of” ở đăng trước. Vậy có thể đơn giản cho word “of” vào trong biến a</li>
<li>“99 bottles of <span class="math">\(a&quot; có thể rewrite tiếp lại thành &quot;99{\)</span>x}s of $a”</li>
<li>Chúng ta có thể xoá “<span class="math">\(i--&quot; trong vòng lặp for, vì thế thêm -- vào trước &quot;\)</span>i==1” ở dòng gần cuối thành “<span class="math">\(i--==1&quot; và vì thế bỏ luôn đoạn (\)</span>i-1) ở sau đó</li>
</ul>
Như vậy solution tiếp theo của chúng ta sẽ là <div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>sol2.php </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="x"> &amp;lt;? &lt;span class=&quot;math&quot;&gt;\(a=&amp;quot; of beer on the wall&amp;quot;; for(\)&lt;/span&gt;i=99;$i&amp;gt;=1;){ &lt;span class=&quot;math&quot;&gt;\(x=&amp;#39;bottle&amp;#39;;\)&lt;/span&gt;i==1?:$x.=‘s’; &lt;span class=&quot;math&quot;&gt;\(b=&amp;quot;&amp;lt;p&amp;gt;\)&lt;/span&gt;i &lt;span class=&quot;math&quot;&gt;\(x\)&lt;/span&gt;a, $i $x of beer.&lt;br&gt;“; &lt;span class=&quot;math&quot;&gt;\(b.=\)&lt;/span&gt;i–==1?”Go to the store and buy some more, 99 {&lt;span class=&quot;math&quot;&gt;\(x}s\)&lt;/span&gt;a.“:”Take one down and pass it around, “.$i.” &lt;span class=&quot;math&quot;&gt;\(x\)&lt;/span&gt;a.</span>
</span><span class='line'><span class="x">&lt;/p&gt;</span>
</span><span class='line'><span class="x">&lt;p&gt;“; echo $b; } </span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>
<p>241 bytes!</p>
<h2 id="the-trick">The trick</h2>
<p>Bạn có nghĩ đã hết cách để rút gọn đoạn code ?</p>
<p>Bạn có quên điều gì không ? Bỏ đi tất cả các ký tự line-feed (line break), cho code thành 1 dòng, chúng ra sẽ có kết quả tốt hơn.</p>
<div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>sol4.php </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="x"> &amp;lt;?&lt;span class=&quot;math&quot;&gt;\(a=&amp;quot; of beer on the wall&amp;quot;;for(\)&lt;/span&gt;i=99;&lt;span class=&quot;math&quot;&gt;\(i&amp;gt;0;){\)&lt;/span&gt;x=‘bottle’;&lt;span class=&quot;math&quot;&gt;\(i^1?\)&lt;/span&gt;x.=‘s’:0;&lt;span class=&quot;math&quot;&gt;\(b=&amp;quot;&amp;lt;p&amp;gt;\)&lt;/span&gt;i &lt;span class=&quot;math&quot;&gt;\(x\)&lt;/span&gt;a, $i &lt;span class=&quot;math&quot;&gt;\(x of beer.&amp;lt;br&amp;gt;&amp;quot;;\)&lt;/span&gt;b.=$ i–==1?“Go to the store and buy some more, 99 {&lt;span class=&quot;math&quot;&gt;\(x}s\)&lt;/span&gt;a.”:“Take one down and pass it around,”.$i.&amp;quot; &lt;span class=&quot;math&quot;&gt;\(x\)&lt;/span&gt;a.</span>
</span><span class='line'><span class="x">&lt;/p&gt;</span>
</span><span class='line'><span class="x">&lt;p&gt;“;echo $b;} </span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>
<p>233 bytes!</p>
<p>Bạn có tin có 1 đoạn code sẽ cho kết quả tương tự với … 30 bytes ???</p>
<p>!!</p>
<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>trick.php </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="x"> </span><span class="cp">&lt;?</span><span class="k">include</span><span class="p">(</span><span class="s1">&#39;http://bit.ly/xxxx&#39;</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x"> </span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>
<p>PHP là 1 ngôn ngữ web! Với allow_url_fopen và allow_url_include turn on có thể dễ dàng load 1 link kết quả có sẵn đi kèm 1 dịch vụ như bitly !</p>
<p>Stay hungry, stay foolish :D</p>
<h2 id="tham-khảo">Tham khảo</h2>
<ol type="1">
<li><a href="http://www.phpgolf.org/tips">phpgolf tips and tricks</a></li>
<li><a href="http://stackoverflow.com/questions/3801097/solve-this-php-puzzle-in-as-few-bytes-as-possible">Question on StackOverFlow</a></li>
</ol>]]></content>
  </entry>
  
</feed>
